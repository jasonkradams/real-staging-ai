- Plans live in Stripe (e.g., `price_...`), mirrored in `plans`
- Webhooks handled at `/api/v1/stripe/webhook` (public route)
- Idempotency enforced via `processed_events` table (unique by `stripe_event_id`)
- On `checkout.session.completed`: create/update userâ€™s `stripe_customer_id`, set plan
- Enforce limits in API (e.g., block new jobs if over plan limit)
- Tests: replay sample events (Stripe CLI), verify signature and idempotency
