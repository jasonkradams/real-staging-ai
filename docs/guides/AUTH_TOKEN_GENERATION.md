# Generating an Auth0 Test Token

This document describes how to generate a test token from Auth0 to authenticate with the virtual staging API.

## Prerequisites

- An Auth0 account. You can create one for free at [https://auth0.com/](https://auth0.com/).

## Step-by-Step Guide

### 1. Create an API in Auth0

1.  Log in to your Auth0 dashboard.
2.  Navigate to **Applications > APIs**.
3.  Click **+ Create API**.
4.  Provide the following information:
    - **Name:** A descriptive name for your API (e.g., "Virtual Staging API").
    - **Identifier:** `https://api.virtualstaging.local`. This is the `audience` the server will expect.
    - **Signing Algorithm:** Keep the default `RS256`.
5.  Click **Create**.

#### Implementation Details

| Name                 | Identifier                                       | Signing Algorithm |
| -------------------- | ------------------------------------------------ | ----------------- |
| Auth0 Management API | https://dev-sleeping-pandas.us.auth0.com/api/v2/ | RS256             |
| Virtual Staging API  | https://api.virtualstaging.local                 | RS256             |

#### Test Settings

These are test instructions generated by Auth0:

**Asking Auth0 for tokens from my application**

Send test payload with Go

```go
package main

import (
  "fmt"
  "strings"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "https://dev-sleeping-pandas.us.auth0.com/oauth/token"

	// see secrets.yml for client_id and client_secret
  payload := strings.NewReader("{\"client_id\":\"REDACTED\",\"client_secret\":\"REDACTED\",\"audience\":\"https://api.virtualstaging.local\",\"grant_type\":\"client_credentials\"}")

  req, _ := http.NewRequest("POST", url, payload)

  req.Header.Add("content-type", "application/json")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))
}
```

In this example, `client_id` and `client_secret` are the ones from the Virtual Staging API (Test Application) application. You can change this values with any from your other authorized applications.

```json
{
  "access_token": "REDACTED", // see secrets.yml
  "token_type": "Bearer"
}
```

**Sending the token to the API**

You can use this `bearer` token with an `Authorization Header` in your request to obtain authorized access to your API.

```go
package main

import (
  "fmt"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "http://path_to_your_api/"

  req, _ := http.NewRequest("GET", url, nil)

  req.Header.Add("Authorization", "Bearer YOUR_AUTH0_TOKEN")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))

}
```

### 2. Create a Single Page Application (SPA)

1.  Navigate to **Applications > Applications**.
2.  Click **+ Create Application**.
3.  Provide the following information:
    - **Name:** A name for your application (e.g., "Virtual Staging Web App").
    - **Application Type:** Select **Single Page Web Applications**.
4.  Click **Create**.

### 3. Get the Test Token

1.  Go back to **Applications > APIs** and select the API you created earlier.
2.  Click on the **Test** tab.
3.  In the **Ask Auth0 for a token** section, you will find a ready-to-use test token.
4.  Click the copy icon to copy the token to your clipboard.

## Using the Token

When making requests to the API, include the token in the `Authorization` header as a Bearer token.

**Example using `curl`:**

```bash
curl -X GET http://localhost:8080/api/v1/projects \
  -H "Authorization: Bearer YOUR_AUTH0_TOKEN"
```

Replace `YOUR_AUTH0_TOKEN` with the token you obtained from the Auth0 dashboard.

## Alternative: Auth0 CLI

For a more streamlined workflow, you can use the Auth0 CLI.

1.  **Install the Auth0 CLI:** Follow the official installation guide at [https://auth0.com/docs/cli](https://auth0.com/docs/cli).
2.  **Log in:**
    ```bash
    auth0 login
    ```
3.  **Get a test token:**
    ```bash
    auth0 test token --audience https://api.virtualstaging.local
    ```

This command will provide you with a test token that you can use for your API requests.

## Test Account Login Details

The following is generated when signing in with Google to Auth0 Account:

```json
{
  "sub": "google-oauth2|102994807213475588448",
  "given_name": "Jason",
  "family_name": "Adams",
  "nickname": "jason.k.r.adams",
  "name": "Jason Adams",
  "picture": "https://lh3.googleusercontent.com/a/ACg8ocJJ2afD8FUjK0ZK0eRoZDogD3z9s-SEBhJXYvKLRckdjq1aqOx7rQ=s96-c",
  "updated_at": "2025-09-04T17:28:54.860Z"
}
```

When signing up with an email/password

```json
{
  "sub": "auth0|68b9ccc45e7d6406ac547a8f",
  "nickname": "jason.k.r.adams",
  "name": "jason.k.r.adams@gmail.com",
  "picture": "https://s.gravatar.com/avatar/5b6cbfa796240e5a93f05d59a1c82916?s=480&r=pg&d=https%3A%2F%2Fcdn.auth0.com%2Favatars%2Fja.png",
  "updated_at": "2025-09-04T17:30:44.739Z"
}
```
